<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tiler Profile | TILERSHUB</title>
  <style>
    :root {
      --primary: #0052cc;
      --accent: #f8b400;
      --light-bg: #f9f9f9;
      --text: #333;
      --border: #ddd;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: var(--light-bg);
      color: var(--text);
    }
    header, footer {
      background: var(--primary);
      color: white;
      text-align: center;
      padding: 15px;
    }
    footer {
      background: #222;
      color: #ccc;
      font-size: 14px;
    }
    .cover {
      height: 150px;
      background-size: cover;
      background-position: center;
    }
    .profile-pic {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 4px solid white;
      margin-top: -50px;
      background-size: cover;
      background-position: center;
    }
    .profile-info {
      text-align: center;
      padding: 10px 20px;
    }
    .stars {
      color: var(--accent);
      font-size: 1.2em;
      margin: 5px 0;
    }
    .bio {
      font-size: 14px;
      color: #555;
      margin-top: 8px;
    }
    .highlight-tag {
      display: inline-block;
      background: var(--accent);
      color: #fff;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 12px;
      margin: 5px 4px;
    }
    .container {
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    .card {
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.05);
      margin-bottom: 20px;
    }
    .rating-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .rating-grid div {
      background: #f1f3f6;
      padding: 10px;
      border-radius: 6px;
      text-align: center;
      font-weight: 500;
    }
    input, select, textarea {
      width: 100%;
      margin: 8px 0;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid var(--border);
      font-size: 14px;
    }
    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px;
      width: 100%;
      border-radius: 6px;
      font-size: 16px;
      margin-top: 10px;
    }
    .review-card {
      border-top: 1px solid #eee;
      margin-top: 10px;
      padding-top: 10px;
    }
    small {
      color: #888;
    }
  </style>
</head>
<body>

<header>
  <strong>TILERSHUB</strong><br>
  Verified Tiler Profile
</header>

<div class="cover" id="coverImage"></div>

<div class="profile-info">
  <div class="profile-pic" id="profilePic"></div>
  <h2 id="tilerName">Loading...</h2>
  <p id="tilerCity">City</p>
  <div class="stars" id="ratingStars">★★★★★</div>
  <div class="bio" id="bioText">Loading bio...</div>
  <div id="highlightTags"></div>
</div>

<div class="container">
  <div class="card">
    <h3>Review Summary</h3>
    <div class="rating-grid">
      <div>Quality of Work: 97%</div>
      <div>Customer Service: 95%</div>
      <div>Timeliness: 90%</div>
      <div>Pricing Fairness: 89%</div>
      <div>Cleanliness: 95%</div>
      <div><strong>93% recommends this tiler</strong></div>
    </div>
  </div>

  <div class="card" id="reviewList">
    <h3>Customer Reviews</h3>
    <div class="review-card">
      <strong>Nadeesha</strong> <small>– Aug 2, 2025</small>
      <div class="stars">★★★★★</div>
      <p>He tiled our entire ground floor. Really satisfied with the detail and work ethic!</p>
    </div>
  </div>

  <div class="card">
    <h3>Leave a Review</h3>
    <input type="text" id="name" placeholder="Your name" />
    <input type="tel" id="phone" placeholder="Your phone number (optional)" />
    <input type="email" id="email" placeholder="Your email address (optional)" />
    <label>Quality of Work</label>
    <select id="quality">
      <option value="5">5 - Excellent</option>
      <option value="4">4 - Good</option>
      <option value="3">3 - Average</option>
    </select>
    <label>Customer Service</label>
    <select id="service"><option>5</option><option>4</option><option>3</option></select>
    <label>Timeline</label>
    <select id="timeline"><option>5</option><option>4</option><option>3</option></select>
    <label>Pricing Fairness</label>
    <select id="pricing"><option>5</option><option>4</option><option>3</option></select>
    <label>Cleanliness</label>
    <select id="cleanliness"><option>5</option><option>4</option><option>3</option></select>
    <textarea id="comment" rows="3" placeholder="Write your feedback (optional)..."></textarea>
    <button onclick="submitReview()">Submit Review</button>
  </div>
</div>

<footer>
  &copy; 2025 TILERSHUB | <a href="/privacy" style="color: var(--accent); text-decoration: none;">Privacy Policy</a> |
  <a id="whatsappLink" href="#" style="color: var(--accent); text-decoration: none;">WhatsApp</a>
</footer>

<script>
  const urlParams = new URLSearchParams(window.location.search);
  const tilerId = urlParams.get("id");

  async function loadTilerProfile() {
    const res = await fetch("/tilers/tilers.json");
    const data = await res.json();
    const tiler = data.find(t => t.id === tilerId);
    if (!tiler) return;

    document.title = tiler.name + " | TILERSHUB";
    document.getElementById("tilerName").textContent = tiler.name;
    document.getElementById("tilerCity").textContent = "Verified Tiler – " + tiler.city;
    document.getElementById("bioText").textContent = tiler.bio || "";
    document.getElementById("highlightTags").innerHTML = (tiler.highlights || []).map(h => `<span class="highlight-tag">${h}</span>`).join('');
    document.getElementById("coverImage").style.backgroundImage = `url('${tiler.cover || '/default-cover.jpg'}')`;
    document.getElementById("profilePic").style.backgroundImage = `url('${tiler.image}')`;
    document.getElementById("whatsappLink").href = "https://wa.me/94" + tiler.whatsapp.replace(/^0/, '');
    document.getElementById("whatsappLink").textContent = "WhatsApp " + tiler.name;
    document.getElementById("ratingStars").innerHTML = '★'.repeat(Math.round(tiler.rating)) + '☆'.repeat(5 - Math.round(tiler.rating));
  }

  function submitReview() {
    const name = document.getElementById("name").value || "Anonymous";
    const phone = document.getElementById("phone").value;
    const email = document.getElementById("email").value;
    const comment = document.getElementById("comment").value;
    const date = new Date().toISOString().split("T")[0];

    const reviewHTML = `
      <div class="review-card">
        <strong>${name}</strong> <small>– ${date}</small>
        <div class="stars">★★★★★</div>
        <p>${comment}</p>
        <p><small>Phone: ${phone || 'N/A'} | Email: ${email || 'N/A'}</small></p>
      </div>`;
    document.getElementById("reviewList").insertAdjacentHTML("beforeend", reviewHTML);
    alert("Review submitted (not saved permanently)");
  }

  loadTilerProfile();
</script>

</body>
</html>