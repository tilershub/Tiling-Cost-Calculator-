<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TilersHUB Cost Estimator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f4f4;
      color: #222;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: center;
    }
    .logo {
      width: 150px;
      margin-bottom: 15px;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      font-size: 16px;
    }
    button {
      background: #004aad;
      color: white;
      border: none;
    }
    .report {
      margin-top: 25px;
      padding: 15px;
      background: #f0f8ff;
      border-left: 5px solid #004aad;
      border-radius: 5px;
      text-align: left;
    }
    .section {
      margin-bottom: 20px;
    }
    .section h3 {
      color: #004aad;
      margin-bottom: 8px;
    }
    .section div {
      margin: 3px 0;
    }
    @media screen and (max-width: 600px) {
      .container { padding: 15px; }
    }
  </style>
</head>
<body>
<div class="container">
  <!-- ‚úÖ Logo with base64 -->
  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABQAAAAUACAYAAAAY5P/3AAEAAElEQVR4nOz9eZ..." class="logo" alt="TilersHUB Logo" />
  <h2 style="color:#004aad;">Tiling Cost Estimator ‚Äì TilersHUB</h2>

  <input id="area" type="number" placeholder="Total Area (sqft)" />
  <label for="tileSize">Select Tile Size:</label>
  <select id="tileSize">
    <option value="300x300">300mm x 300mm</option>
    <option value="600x600">600mm x 600mm</option>
    <option value="600x1200">600mm x 1200mm</option>
  </select>
  <input id="tilePrice" type="number" placeholder="Tile Price (LKR)" />
  <input id="cementPrice" type="number" placeholder="Cement Price (LKR)" />
  <input id="sandPrice" type="number" placeholder="Sand Price (LKR)" />
  <input id="adhesivePrice" type="number" placeholder="Tile Adhesive Price (LKR)" />
  <input id="clipPrice" type="number" placeholder="Leveling Clip Price (LKR)" />
  <input id="groutPrice" type="number" placeholder="Grout Price (LKR)" />

  <button onclick="calculate()">Calculate</button>
  <button onclick="downloadPDF()">Download PDF</button>

  <div id="report" class="report" style="display:none;"></div>
</div>
<script>
  const { jsPDF } = window.jspdf;

  const logoBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABQAAAAUACAYAAAAY5P/3AAEAAElEQVR4nOz9eZ..."; // (paste full base64 string here)

  function getTileSettings(selected) {
    if (selected === "300x300") {
      return { sqft: 0.96, laborMin: 80, laborMax: 120, skirtingCoverage: 3 };
    } else if (selected === "600x600") {
      return { sqft: 3.87, laborMin: 80, laborMax: 120, skirtingCoverage: 12 };
    } else if (selected === "600x1200") {
      return { sqft: 7.75, laborMin: 110, laborMax: 150, skirtingCoverage: 24 };
    }
  }

  let latestLines = [];

  function calculate() {
    const sqft = parseFloat(document.getElementById("area").value);
    const tileType = document.getElementById("tileSize").value;
    const settings = getTileSettings(tileType);
    const skirting = Math.ceil(sqft * 0.2);

    const floorTiles = Math.ceil(sqft / settings.sqft);
    const skirtingTiles = Math.ceil(skirting / settings.skirtingCoverage);
    const totalTilesNoWastage = floorTiles + skirtingTiles;
    const totalTiles = Math.ceil(totalTilesNoWastage * 1.05);
    const tilePrice = parseFloat(document.getElementById("tilePrice").value);
    const tileCost = tilePrice * totalTiles;

    const cementPrice = parseFloat(document.getElementById("cementPrice").value);
    const sandPrice = parseFloat(document.getElementById("sandPrice").value);
    const adhesivePrice = parseFloat(document.getElementById("adhesivePrice").value);
    const clipPrice = parseFloat(document.getElementById("clipPrice").value);
    const groutPrice = parseFloat(document.getElementById("groutPrice").value);

    const cementMin = 10 * sqft / 1000;
    const cementMax = 14 * sqft / 1000;
    const sandMin = 1.25 * sqft / 1000;
    const sandMax = 1.75 * sqft / 1000;
    const adhesiveMin = 25 * sqft / 1000;
    const adhesiveMax = 40 * sqft / 1000;
    const clipQty = Math.ceil(sqft / 100);
    const groutQty = Math.ceil(sqft / 175);

    const materialMin = tileCost + cementMin * cementPrice + sandMin * sandPrice + adhesiveMin * adhesivePrice + clipQty * clipPrice + groutQty * groutPrice;
    const materialMax = tileCost + cementMax * cementPrice + sandMax * sandPrice + adhesiveMax * adhesivePrice + clipQty * clipPrice + groutQty * groutPrice;

    const reportEl = document.getElementById("report");
    reportEl.innerHTML = `
      <div class="section"><h3>üìê Project Summary</h3>
        <div>Area: ${sqft} sqft</div>
        <div>Tile Size: ${tileType.replace("x", "mm x ")} mm</div>
        <div>Skirting (auto): ${skirting} ft</div>
      </div>
      <div class="section"><h3>üì¶ Materials Estimate</h3>
        <div>Floor Tile Quantity: ${floorTiles}</div>
        <div>Skirting Tile Quantity: ${skirtingTiles}</div>
        <div>Total Tile Quantity (before wastage): ${totalTilesNoWastage}</div>
        <div>Total Tile Quantity (with 5% wastage): ${totalTiles}</div>
        <div>Tile Cost: LKR ${tileCost.toFixed(0)}</div>
        <div>Cement: ${cementMin.toFixed(2)} ‚Äì ${cementMax.toFixed(2)} bags</div>
        <div>Sand: ${sandMin.toFixed(2)} ‚Äì ${sandMax.toFixed(2)} cubes</div>
        <div>Tile Adhesive: ${adhesiveMin.toFixed(2)} ‚Äì ${adhesiveMax.toFixed(2)} bags</div>
        <div>Leveling Clips: ${clipQty} packs</div>
        <div>Grout: ${groutQty} kg</div>
      </div>
      <div class="section"><h3>üë∑ Labor Cost Range</h3>
        <div>LKR ${settings.laborMin * sqft} ‚Äì LKR ${settings.laborMax * sqft}</div>
      </div>
      <div class="section"><h3>üí∞ Total Project Estimate</h3>
        <div>Minimum: LKR ${(materialMin + settings.laborMin * sqft).toFixed(0)}</div>
        <div>Maximum: LKR ${(materialMax + settings.laborMax * sqft).toFixed(0)}</div>
      </div>`;
    reportEl.style.display = "block";

    latestLines = [...reportEl.innerText.split('\\n')];
  }

  function downloadPDF() {
    const doc = new jsPDF();

    const logo = new Image();
    logo.src = logoBase64;

    logo.onload = function () {
      doc.setFillColor(0, 74, 173);
      doc.rect(0, 0, 210, 30, 'F');
      doc.addImage(logo, "PNG", 10, 5, 30, 20);
      doc.setFontSize(14);
      doc.setTextColor(255);
      doc.text("Tiling Cost Estimator ‚Äì TilersHUB", 45, 18);

      doc.setFontSize(11);
      doc.setTextColor(0);
      doc.text(latestLines, 10, 40);

      const height = doc.internal.pageSize.height;
      doc.setFontSize(9);
      doc.setTextColor(100);
      doc.text("Find 100% verified professional tilers ‚Äì www.tilershub.lk", 10, height - 15);
      doc.text("WhatsApp: 0774503744", 10, height - 8);
      doc.text("Page 1 of 1", 170, height - 8);

      doc.save("TilersHUB_Tiling_Report.pdf");
    };
  }
</script>
</body>
</html>
